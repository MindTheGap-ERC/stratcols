<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Quantifying stratigraphic order • stratcols</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quantifying stratigraphic order">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">stratcols</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/stratcols.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/stratcols_doc.html">Structure and classes of the stratcols package</a></li>
    <li><a class="dropdown-item" href="../articles/stratorder.html">Quantifying stratigraphic order</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MindTheGap-ERC/stratcols/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Quantifying stratigraphic order</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MindTheGap-ERC/stratcols/blob/main/vignettes/stratorder.Rmd" class="external-link"><code>vignettes/stratorder.Rmd</code></a></small>
      <div class="d-none name"><code>stratorder.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mindthegap-erc.github.io/stratcols/">stratcols</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette describes how to quantify stratigraphic order using the
metrics defined by Burgess (2016).</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>First, we define a stratigraphic column:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="../reference/as_stratcol.html">as_stratcol</a></span><span class="op">(</span>thickness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>, <span class="co"># random bed thicknesses</span></span>
<span>                facies <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span> <span class="co"># repeat facies 1, 2 and 3 </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></code></pre></div>
<p><img src="stratorder_files/figure-html/unnamed-chunk-2-1.png" alt="A stratigraphic column with 3 facies" width="700"></p>
</div>
<div class="section level2">
<h2 id="estimating-markov-metrics">Estimating Markov metrics<a class="anchor" aria-label="anchor" href="#estimating-markov-metrics"></a>
</h2>
<p>We can then estimate the transition matrix between facies using</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/transition_matrix.html">transition_matrix</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span>
<span><span class="va">m</span></span>
<span><span class="co">#&gt;    from</span></span>
<span><span class="co">#&gt; to  1 2 3</span></span>
<span><span class="co">#&gt;   1 0 0 1</span></span>
<span><span class="co">#&gt;   2 1 0 0</span></span>
<span><span class="co">#&gt;   3 0 1 0</span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "fa_tran_mat_p"</span></span></code></pre></div>
<p>and estimate the markov order metric (MOM) from it using</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_mom.html">get_mom</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimating-run-metrics">Estimating run metrics<a class="anchor" aria-label="anchor" href="#estimating-run-metrics"></a>
</h2>
<p>The run order metrics (ROM) can be estimated using</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rom_observed</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_rom.html">get_rom</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span>
<span><span class="va">rom_observed</span></span>
<span><span class="co">#&gt; [1] 1.41573</span></span></code></pre></div>
<p>To put this value into context, we randomize the section to estimate
the distribution of rom values</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">10000</span></span>
<span><span class="va">rom_vals</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">randomized_column</span> <span class="op">=</span> <span class="fu"><a href="../reference/shuffle_col.html">shuffle_col</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span>
<span>  <span class="va">rom_vals</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_rom.html">get_rom</a></span><span class="op">(</span><span class="va">randomized_column</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">rom_vals</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"distribution of ROM values"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">rom_observed</span>, <span class="fl">2</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="stratorder_files/figure-html/unnamed-chunk-6-1.png" alt="Histogram of ROM values" width="700">
Here the red line indicates how extreme the rom value of the
stratigraphic column <code>s</code> is compared to the expected
distribution of rom values based on random reordering of the beds.</p>
</div>
<div class="section level2">
<h2 id="estimating-markov-order-metrics">Estimating Markov Order Metrics<a class="anchor" aria-label="anchor" href="#estimating-markov-order-metrics"></a>
</h2>
<p>To estimate markov order metrics, some data preparation is needed to
make sure all assumptions on the encoding of the stratigraphic column
are met. Let’s start by defining an example stratigraphic column:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="../reference/as_stratcol.html">as_stratcol</a></span><span class="op">(</span>thickness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>, fa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="co"># uniform bed thickness, ordered facies</span></span>
<span><span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="../reference/shuffle_col.html">shuffle_col</a></span><span class="op">(</span><span class="va">s</span>, allow_rep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># randomize order of beds, allowing  for repetitions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></code></pre></div>
<p><img src="stratorder_files/figure-html/unnamed-chunk-7-1.png" alt="A stratigraphic column with randomly ordered beds" width="700"></p>
<div class="section level3">
<h3 id="check-for-successive-beds-with-identical-facies">Check for successive beds with identical facies<a class="anchor" aria-label="anchor" href="#check-for-successive-beds-with-identical-facies"></a>
</h3>
<p>MOM only examines transitions between facies, and ignores beds with
identical facies. To meet this criterion, we first need to merge all
beds with identical facies:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s_merged</span> <span class="op">=</span> <span class="fu"><a href="../reference/merge_beds.html">merge_beds</a></span><span class="op">(</span><span class="va">s</span>, mode <span class="op">=</span> <span class="st">"identical facies"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s_merged</span><span class="op">)</span></span></code></pre></div>
<p><img src="stratorder_files/figure-html/unnamed-chunk-8-1.png" alt="A stratigraphic column with beds with identical facies merged" width="700">
### Rearrange facies names</p>
<p>The next assumption is that facies are enumerated using integers
based on their order of appearance in the column. We can do this using
<code>order_facies_names</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s_ord_names</span> <span class="op">=</span> <span class="fu"><a href="../reference/order_facies_names.html">order_facies_names</a></span><span class="op">(</span><span class="va">s_merged</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s_ord_names</span><span class="op">)</span></span></code></pre></div>
<p><img src="stratorder_files/figure-html/unnamed-chunk-9-1.png" alt="A stratigraphic column with ordered facies names" width="700">
### estimating the transition matrix</p>
<p>Now we can estimate the facies transition matrix:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/transition_matrix.html">transition_matrix</a></span><span class="op">(</span><span class="va">s_ord_names</span><span class="op">)</span></span>
<span><span class="va">m</span></span>
<span><span class="co">#&gt;    from</span></span>
<span><span class="co">#&gt; to          1         2         3</span></span>
<span><span class="co">#&gt;   1 0.0000000 0.8333333 0.1666667</span></span>
<span><span class="co">#&gt;   2 0.1428571 0.0000000 0.8571429</span></span>
<span><span class="co">#&gt;   3 0.7142857 0.2857143 0.0000000</span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "fa_tran_mat_p"</span></span></code></pre></div>
<p>Note that because we have merged beds with identical facies, entries
on the diagonal are 0 - facies do not transition into themselves.</p>
</div>
<div class="section level3">
<h3 id="estimating-mom">Estimating MOM<a class="anchor" aria-label="anchor" href="#estimating-mom"></a>
</h3>
<p>From the facies transition matrix, MOM can be estimated via</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_mom.html">get_mom</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.6031746</span></span></code></pre></div>
<p>A MOM value of 0 indicates unordered facies, a value of 1 reflects
perfect order and deterministic transitions between facies.</p>
</div>
</div>
<div class="section level2">
<h2 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<p>See also</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"stratcols_doc"</span><span class="op">)</span></span></code></pre></div>
<p>for a description of the classes used in the package and a
description of the larger scale structure.</p>
<p>See</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"stratcols"</span><span class="op">)</span></span></code></pre></div>
<p>for an overview of the available functionalit of the
<code>stratcols</code> package, including how to create stratigraphic
columns, plot them and modify them.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Burgess, Peter. 2016. “Identifying Ordered Strata: Evidence,
Methods, and Meaning.” Journal of Sedimentary Research. </li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Niklas Hohmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
